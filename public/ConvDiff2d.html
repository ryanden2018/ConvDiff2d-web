<!doctypehtml><html lang=en-us><head><meta charset=utf-8><meta content="text/html; charset=utf-8"http-equiv=Content-Type><title>Steady-state Advection-Diffusion Solver</title><style>.emscripten{padding-right:0;margin-left:auto;margin-right:auto;display:block}textarea.emscripten{font-family:monospace;width:80%}div.text1{padding:5px}div.text2{padding:15px}div.text1,div.text2,h2{color:#353535;font-family:'Lucida Sans','Lucida Sans Regular','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,sans-serif}div.text2{line-height:1.5}a:active,a:link,a:visited{color:#353535}a:hover{color:#000}div.emscripten{text-align:center}div.emscripten_border{border:1px solid #000}div.eqn{text-align:center}canvas.emscripten{border:0 none;background-color:#000;width:693px;height:693px}.spinner{height:50px;width:50px;margin:0 auto;-webkit-animation:rotation .8s linear infinite;-moz-animation:rotation .8s linear infinite;-o-animation:rotation .8s linear infinite;animation:rotation .8s linear infinite;border-left:10px solid #0096f0;border-right:10px solid #0096f0;border-bottom:10px solid #0096f0;border-top:10px solid #6400c8;border-radius:100%;background-color:#c864fa}@-webkit-keyframes rotation{from{-webkit-transform:rotate(0)}to{-webkit-transform:rotate(360deg)}}@-moz-keyframes rotation{from{-moz-transform:rotate(0)}to{-moz-transform:rotate(360deg)}}@-o-keyframes rotation{from{-o-transform:rotate(0)}to{-o-transform:rotate(360deg)}}@keyframes rotation{from{transform:rotate(0)}to{transform:rotate(360deg)}}</style></head><body><h2>Steady-state Advection-Diffusion Solver</h2><div class=text1><i>Ryan Denlinger</i></div><div class=text1>To see this demo you will need to use a modern browser which supports WebAssembly; feel free to try the  <a href=ConvDiff2dJS.html>JavaScript version</a>  if nothing appears below.</div><div class=text1><b>CLICK</b>  or  <b>CLICK AND DRAG</b>  to alter the flow velocity.</div><div class=text1>(<b>TOUCH</b>  or  <b>TOUCH AND DRAG</b>  on touch-enabled devices.)</div><div class=text1>The code for this demo is available on  <a href=https://github.com/ryanden2018/ConvDiff2d/ target=_blank>GitHub</a>.</div><div class=text1>An explanation of the math behind this demo is provided below.</div><hr><figure id=spinner style=overflow:visible><div class=spinner></div><center style=margin-top:.5em><strong>emscripten</strong></center></figure><div class=emscripten id=status>Downloading...</div><div class=emscripten><progress hidden id=progress max=100 value=0></progress></div><div class=emscripten_border><canvas class=emscripten id=canvas oncontextmenu=event.preventDefault() tabindex=-1></canvas></div><textarea class=emscripten id=output rows=8></textarea><hr><h2>What is this?</h2><div class=text2>An advection-diffusion equation is a partial differential equation (PDE) which describes a spreading (diffusing) concentration distribution under the influence of some external flow velocity. The canonical example is:</div><div class=eqn><img height=75 src=eq1.png></div><div class=text2>where  <i>f</i>  is the concentration and  <i>g</i>  is the source. In this demo we are solving a steady-state version of this equation, obtained by setting the time derivative to zero (<i>g</i>  must have mean zero):</div><div class=eqn><img height=75 src=eq2.png></div><div class=text2>Additionally we set the velocity  <b>u</b>  to a constant, which starts at zero and is thereafter determined through user interaction. The PDE is solved on a unit square with periodic boundary conditions. The right-hand side is given by the following formula:</div><div class=eqn><img height=75 src=eq3.png></div><div class=text2>where</div><div class=eqn><img height=75 src=eq4.png></div><div class=text2>The numerical method for this demo is the Discontinuous Gelerkin (DG) method (with interior penalty to handle the diffusion). DG is an alternative to classical finite element (FEM) and finite volume (FVM) methods, and arises by combining aspects of both. In the DG method, we expand the solution in a basis of piecewise polynomial functions, and integrate against test functions from the same space to generate a discrete system of equations. In particular the computed solution is typically discontinuous.</div><div class=text2>The demo actually solves two problems: a fast one, and a slow one. The fast solve employs a 11 by 11 grid with linear basis functions in each cell (a 363 by 363 system). The slow solve employs a 3 by 3 grid with tenth order basis functions in each cell (a 594 by 594 system).</div><div class=text2>The console window will display two numbers at the conclusion of each slow solve. The first number is the residual from solving the linear system; this number is expected to be small because it does not account for truncation error. The second number is the spatial residual computed via the following formula:</div><div class=eqn><img height=100 src=eq5.png></div><div class=text2>To compute the derivatives appearing in the residual, high-order finite difference formulas are applied to the solution values evaluated at points which are chosen away from cell boundaries.</div><div class=text2>The DG solver is written in C++, using the  <a href=http://eigen.tuxfamily.org target=_blank>Eigen</a>  package for linear algebra and  <a href=https://emscripten.org/ target=_blank>Emscripten</a>  to compile down to WebAssembly.</div><script>var statusElement=document.getElementById("status"),progressElement=document.getElementById("progress"),spinnerElement=document.getElementById("spinner"),Module={preRun:[],postRun:[],print:function(){var e=document.getElementById("output");return e&&(e.value=""),function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments).join(" ")),console.log(t),e&&(e.value+=t+"\n",e.scrollTop=e.scrollHeight)}}(),printErr:function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments).join(" ")),console.error(e)},canvas:function(){var e=document.getElementById("canvas");return e.addEventListener("webglcontextlost",(function(e){alert("WebGL context lost. You will need to reload the page."),e.preventDefault()}),!1),e}(),setStatus:function(e){if(Module.setStatus.last||(Module.setStatus.last={time:Date.now(),text:""}),e!==Module.setStatus.last.text){var t=e.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/),n=Date.now();t&&n-Module.setStatus.last.time<30||(Module.setStatus.last.time=n,Module.setStatus.last.text=e,t?(e=t[1],progressElement.value=100*parseInt(t[2]),progressElement.max=100*parseInt(t[4]),progressElement.hidden=!1,spinnerElement.hidden=!1):(progressElement.value=null,progressElement.max=null,progressElement.hidden=!0,e||(spinnerElement.hidden=!0)),statusElement.innerHTML=e)}},totalDependencies:0,monitorRunDependencies:function(e){this.totalDependencies=Math.max(this.totalDependencies,e),Module.setStatus(e?"Preparing... ("+(this.totalDependencies-e)+"/"+this.totalDependencies+")":"All downloads complete.")}};Module.setStatus("Downloading..."),window.onerror=function(){Module.setStatus("Exception thrown, see JavaScript console"),spinnerElement.style.display="none",Module.setStatus=function(e){e&&Module.printErr("[post-exception status] "+e)}}</script><script async src=ConvDiff2d.js></script></body></html>